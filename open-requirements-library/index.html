<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=dev        .logo-container {
            padding: 1rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            background-color: var(--blue-700);
            width: 100%;
            box-sizing: border-box;
            margin-top: auto; /* Push to bottom using flexbox */
        }ial-scale=1.0">
    <title>CivicActions' Open Practice Guides</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* WCAG 2.2 AAA compliant colors */
            --blue-700: #1a4480;
            --blue-800: #162e51;
            --blue-100: #d4e5ff;
            --red-700: #6A0000;
            --red-800: #4B0000;
            --red-100: #FADAD6;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --link-color: #FADAD6;
        }

        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            min-height: 100vh;
            background-color: var(--gray-100);
            color: var(--gray-800);
        }
        
        body.no-scroll {
            overflow: hidden;
        }

        .scrollbar-hidden::-webkit-scrollbar {
            display: none;
        }

        .scrollbar-hidden {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #000;
            color: #fff;
            padding: 8px;
            z-index: 1000;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 0;
        }

        .sidebar {
            width: 16rem;
            flex-shrink: 0;
            background-color: var(--blue-700);
            color: var(--link-color);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease-in-out;
        }
        
        .sidebar.is-active {
            transform: translateX(0);
        }

        .sidebar-header {
            padding: 1.5rem;
        }

        .sidebar-header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 0.05em;
        }

        .sidebar-header p {
            font-size: 0.875rem;
            color: var(--blue-100);
            margin-top: 0.25rem;
        }

        .navigation-list {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            padding-bottom: calc(1rem + 120px); /* Add space for fixed logo container */
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            list-style: none;
            margin: 0;
        }

        .navigation-list li {
            list-style: none;
        }
        
        .logo-container {
            position: fixed; /* Changed to absolute to stay within sidebar */
            bottom: 0;
            left: 0;
            width: 16rem; /* Same as sidebar width */
            padding: 1rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            background-color: var(--blue-700);
            box-sizing: border-box;
            z-index: 95;
        }

        .navigation-link {
            display: block;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: background-color 0.2s;
            color: var(--link-color);
            text-decoration: none;
        }

        .navigation-link:hover {
            background-color: var(--blue-800);
            text-decoration: underline;
        }

        .navigation-link.active {
            background-color: var(--blue-800);
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 2rem;
            overflow-y: auto;
        }

        .content-wrapper {
            max-width: 56rem;
            margin: 0 auto;
            width: 100%;
        }

        .content-container {
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        /* Styles for markdown content, adjusted for contrast */
        .content-container h1 {
            font-size: 2.25rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 1rem;
        }

        .content-container h2 {
            font-size: 1.875rem;
            font-weight: 600;
            color: var(--gray-800);
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }

        .content-container h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--gray-800);
            margin-top: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .content-container p {
            font-size: 1rem;
            line-height: 1.75rem;
            color: var(--gray-600);
            margin-top: 1rem;
            margin-bottom: 1rem;
        }

        .content-container ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            margin-top: 0.5rem;
        }

        .content-container ol {
            list-style-type: decimal;
            margin-left: 1.5rem;
            margin-top: 0.5rem;
        }

        .content-container li {
            margin-bottom: 0.25rem;
        }

        .content-container a {
            color: var(--blue-700);
            text-decoration: underline;
        }

        .content-container img {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem;
            margin-top: 1rem;
            margin-bottom: 1rem;
        }

        .content-container pre {
            background-color: var(--gray-800);
            color: white;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow: auto;
            font-family: monospace;
            /* Make it focusable for keyboard users */
            outline: 2px solid transparent;
            transition: outline-color 0.2s;
        }

        .content-container pre:focus-within {
            outline-color: var(--blue-700);
        }

        .content-container code {
            background-color: var(--gray-200);
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-weight: 600;
            color: var(--gray-800);
        }

        .logo-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 16rem;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            background-color: var(--blue-700);
            box-sizing: border-box;
            z-index: 95;
        }

        .logo-container a {
            width: 100%;
            display: block;
            text-align: center;
        }

        .logo-container svg {
            width: auto;
            height: auto;
            max-width: 90%;
            max-height: 2.5rem;
            display: inline-block;
            fill: currentColor;
            overflow: visible;
        }

        .logo-container ul {
            list-style: none;
            padding: 0;
            margin: 0.5rem 0 0 0;
            text-align: center;
        }

        .logo-container ul li {
            margin: 0.25rem 0;
        }

        .logo-container ul li a {
            color: var(--link-color);
            text-decoration: none;
            font-size: 0.875rem;
        }

        .logo-container ul li a:hover {
            text-decoration: underline;
        }        .logo-container ul {
            list-style: none;
            padding: 0;
            margin: 0.5rem 0 0 0;
            text-align: center;
        }

        .logo-container ul li {
            margin: 0.25rem 0;
        }

        .logo-container ul li a {
            color: var(--link-color);
            text-decoration: none;
            font-size: 0.875rem;
        }

        .logo-container ul li a:hover {
            text-decoration: underline;
        }

        /* Pagination and bottom links styles */
        .pagination-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 2rem;
            gap: 1rem;
        }

        .pagination-button {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            background-color: white;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            color: var(--gray-700);
            transition: background-color 0.2s;
            text-decoration: none;
        }

        .pagination-button:hover {
            background-color: var(--gray-200);
            text-decoration: underline;
        }

        .bottom-links-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .improve-page-link {
            font-size: 0.875rem;
            color: var(--gray-700);
            text-decoration: underline;
        }

        .improve-page-link:hover {
            color: var(--blue-700);
        }

        .back-to-top-button {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            background-color: transparent;
            color: var(--gray-700);
            transition: color 0.2s;
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .back-to-top-button:hover {
            color: var(--blue-700);
            text-decoration: underline;
        }
        
        /* New CSS for the Hamburger Menu Button */
        .hamburger-menu {
            display: none; /* Hidden by default on desktop */
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 100;
            background-color: var(--blue-700);
            color: var(--link-color);
            border: 1px solid var(--blue-100);
            padding: 0.75rem;
            border-radius: 0.5rem;
            cursor: pointer;
        }
        
        .hamburger-icon {
            display: block;
            position: relative;
            width: 24px;
            height: 2px;
            background: var(--link-color);
            transition: transform 0.3s ease-in-out;
        }

        .hamburger-icon::before,
        .hamburger-icon::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 2px;
            background: var(--link-color);
            transition: transform 0.3s ease-in-out;
        }

        .hamburger-icon::before {
            top: -8px;
        }

        .hamburger-icon::after {
            top: 8px;
        }
        
        /* Styles for when the menu is active/open */
        .hamburger-menu.active .hamburger-icon {
            transform: rotate(45deg);
        }

        .hamburger-menu.active .hamburger-icon::before {
            transform: rotate(-90deg) translate(-8px, 0);
            top: 0;
        }

        .hamburger-menu.active .hamburger-icon::after {
            transform: translate(-8px, 0);
            opacity: 0;
        }
        
        /* Styles for the modal overlay */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* background-color: rgba(0, 0, 0, 0.5); */
                   display: none;
                    opacity: 0;
                    transition: opacity 0.3s ease-in-out;
            
            /* z-index: 90; */
        }

        .sidebar-overlay.is-active {
            display: block;
                      opacity: 1;
        }
        
        

        /* Responsive CSS for mobile devices */
        @media (max-width: 768px) {
            body {
                flex-direction: column;
            }

            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100%;
                z-index: 100;
                transform: translateX(-100%);
                width: 80%;
                max-width: 300px;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
                flex-direction: column;
            }
            
            /* Show the hamburger menu button on mobile */
            .hamburger-menu {
                display: block;
            }

            .sidebar-header {
                padding: 1.5rem;
            }

            .sidebar-header h1 {
                font-size: 1.5rem;
            }

            .sidebar-header p {
                display: block;
            }

            /* Keep the navigation list vertical inside the pop-up */
            .navigation-list {
                flex-direction: column;
                overflow-x: hidden;
                overflow-y: auto;
            }

            .navigation-list-items {
                flex-direction: column;
                gap: 0.25rem;
            }

            .navigation-list-items li {
                flex-shrink: 0;
            }

            .navigation-link {
                padding: 0.5rem 0.75rem;
                font-size: 1rem;
                white-space: normal;
            }

            .logo-container {
                width: 100%;
                border-top: 1px solid rgba(255, 255, 255, 0.2);
            }

            .main-content {
                padding: 1rem;
                padding-bottom: calc(1rem + 120px); /* Add space for fixed logo container */
            }
        }
        
        /* Print-friendly CSS to hide sidebar and footer */
        @media print {
            .sidebar,
            .pagination-container,
            .back-to-top-button,
            .improve-page-link,
            .bottom-links-wrapper {
                display: none;
            }

            .main-content {
                margin: 0 !important;
                padding: 0 !important;
                width: 100% !important;
                min-height: auto !important;
                overflow: visible !important;
            }

            .content-container {
                box-shadow: none;
                padding: 0;
                border-radius: 0;
            }

            /* Ensure the content is visible on a white background */
            body {
                background-color: white;
            }
        }
    </style>
</head>
<body class="body-container">
    <a href="#content-container" class="skip-link">Skip to main content</a>
    <button id="hamburger-menu-button" class="hamburger-menu" aria-label="Open navigation menu" aria-controls="sidebar" aria-expanded="false">
        <span class="hamburger-icon" aria-hidden="true"></span>
    </button>
    
    <div id="sidebar-overlay" class="sidebar-overlay"></div>

    <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h1>CivicActions' Open Practices</h1>
            <p>Open Requirements Library</p>
        </div>
        <nav id="navigation" class="navigation-list">
            <ul class="navigation-list-items">
                <li>
                    <p style="color: var(--blue-100); font-size: 0.875rem; padding: 1rem; animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;">Loading navigation...</p>
                </li>
            </ul>
        </nav>
    </aside>

    <main id="main-content" class="main-content" tabindex="-1">
        <div class="content-wrapper">
            <article id="content-container" class="content-container">
                <h1>Welcome</h1>
                <p>
                    Select a document from the navigation sidebar to get started. The content will appear here.
                </p>
            </article>

            <div id="pagination-container" class="pagination-container">
                </div>
        </div>
    </main>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
    // Use an IIFE (Immediately Invoked Function Expression) to avoid global scope pollution
    (async function() {
        // Configuration for the repository and branch
        const repoOwner = 'CivicActions';
        const repoName = 'open-practice';
        const branch = 'main';
        const contentPath = 'open-requirements-library';

        // DOM elements
        const navigationContainer = document.getElementById('navigation').querySelector('ul');
        const contentContainer = document.getElementById('content-container');
        const paginationContainer = document.getElementById('pagination-container');
        
        // New: DOM elements for the hamburger menu
        const hamburgerButton = document.getElementById('hamburger-menu-button');
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebar-overlay');

        // New: Function to toggle the menu open/closed
        function toggleMenu() {
            sidebar.classList.toggle('is-active');
            sidebarOverlay.classList.toggle('is-active');
            hamburgerButton.classList.toggle('active');
            const isExpanded = hamburgerButton.getAttribute('aria-expanded') === 'true';
            hamburgerButton.setAttribute('aria-expanded', !isExpanded);
            /* document.body.classList.toggle('no-scroll'); // Add a class to prevent body scrolling */
        }

        // New: Add event listeners for the menu button and overlay
        hamburgerButton.addEventListener('click', toggleMenu);
        sidebarOverlay.addEventListener('click', toggleMenu);

        // New: Add event listener to close menu when a link is clicked
        navigationContainer.addEventListener('click', (event) => {
            if (event.target.closest('.navigation-link')) {
                toggleMenu();
            }
        });

        // Global variable to store the file list and current file index
        let markdownFiles = [];

        // Function to fetch the list of files from GitHub's API
        async function fetchFileList() {
            const url = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${contentPath}?ref=${branch}`;
            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`GitHub API error: ${response.statusText}`);
                }
                const files = await response.json();
                const mdFiles = files.filter(file => file.name.endsWith('.md'));
                // Create logo container after files are loaded
                createLogoContainer();
                return mdFiles;
            } catch (error) {
                console.error("Failed to fetch file list:", error);
                navigationContainer.innerHTML = '<li><p style="color: var(--blue-100); font-size: 0.875rem; padding: 1rem; animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;">Error loading files. Check console for details.</p></li>';
                return [];
            }
        }

        // Function to fetch and render the content of a markdown file
        async function fetchAndRenderMarkdown(filename) {
            const index = markdownFiles.findIndex(file => file.name === filename);
            const url = `https://raw.githubusercontent.com/${repoOwner}/${repoName}/${branch}/${contentPath}/${filename}`;
            contentContainer.innerHTML = `<p style="text-align: center; color: var(--gray-500); padding: 2rem 0;">Loading ${filename}...</p>`;
            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`Failed to fetch markdown file: ${response.statusText}`);
                }
                const markdownText = await response.text();
                // Use marked.js to convert markdown to HTML
                const html = marked.parse(markdownText);
                contentContainer.innerHTML = html;
                
                // Add tabindex to pre tags for keyboard navigation
                document.querySelectorAll('pre').forEach(pre => {
                    pre.setAttribute('tabindex', '0');
                });

                // Update the pagination links after content is loaded
                updatePagination(index);
                
                // Update the active link
                updateActiveLink(filename);

                // Use pushState to update the URL without reloading the page
                const newUrl = `${window.location.protocol}//${window.location.host}${window.location.pathname}?file=${filename}`;
                window.history.pushState({ path: newUrl }, '', newUrl);

                // Scroll to the top of the content area
                contentContainer.scrollTop = 0;
            } catch (error) {
                console.error("Failed to fetch and render markdown:", error);
                contentContainer.innerHTML = `<p style="color: var(--blue-700); padding: 2rem 0;">Error loading content. Please try again later.</p>`;
                // Clear pagination on error
                paginationContainer.innerHTML = '';
            }
        }
        
        // Function to create and append the logo container
        function createLogoContainer() {
            const sidebar = document.getElementById('sidebar');
            const existingLogo = document.querySelector('.logo-container');
            
            // Remove existing logo container if it exists
            if (existingLogo) {
                existingLogo.remove();
            }

            const logoContainer = document.createElement('div');
            logoContainer.className = 'logo-container';
            logoContainer.innerHTML = `
                <a href="https://civicactions.com/">
                    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="title" viewBox="0 0 250 39.474" width="250" height="39.474"><title id="title">CivicActions Logo</title><path fill="#f9f9f7" d="M24.323 12.577H21.13q-1.451 0-1.451-1.451V8.978a3.54 3.54 0 0 0-.967-2.535 3.2 3.2 0 0 0-2.322-1.084H9.385a3 3 0 0 0-2.322 1.026 3.48 3.48 0 0 0-1.026 2.593v21.517a3.56 3.56 0 0 0 .987 2.535 3.2 3.2 0 0 0 2.322 1.084h7.063a2.96 2.96 0 0 0 2.264-1.026 3.5 3.5 0 0 0 1.026-2.593v-2.206c0-.929.484-1.413 1.451-1.413h3.135c.967 0 1.451.484 1.451 1.413v2.206a8.48 8.48 0 0 1-2.709 6.424 9.33 9.33 0 0 1-6.618 2.515H9.346a9.3 9.3 0 0 1-6.579-2.515A8.32 8.32 0 0 1 0 30.495V8.978a8.48 8.48 0 0 1 2.709-6.424A9.56 9.56 0 0 1 9.404 0h7.005a9.33 9.33 0 0 1 6.617 2.515 8.32 8.32 0 0 1 2.748 6.443v2.206c0 .909-.503 1.393-1.471 1.393m9.481-4.663h-3.173c-.967 0-1.471-.484-1.471-1.413V3.966c0-.929.503-1.413 1.471-1.413h3.173c.967 0 1.451.484 1.451 1.393v2.515c0 .948-.484 1.432-1.451 1.432m0 31.54h-3.173c-.967 0-1.471-.484-1.471-1.413V12.672c0-.929.503-1.413 1.471-1.413h3.173c.967 0 1.451.484 1.451 1.413V38.02c0 .929-.484 1.413-1.451 1.413m20.046-1.142a1.47 1.47 0 0 1-1.548 1.142h-3.907a1.55 1.55 0 0 1-1.606-1.142l-8.127-25.464a.8.8 0 0 1-.058-.387c0-.813.426-1.238 1.354-1.238h3.019a1.47 1.47 0 0 1 1.548 1.142l5.805 18.189 5.805-18.189a1.59 1.59 0 0 1 1.625-1.142h2.98c.909 0 1.354.426 1.354 1.238a.8.8 0 0 1-.077.387zm16.06-30.36h-3.193c-.967 0-1.451-.484-1.451-1.413V4.003c0-.929.484-1.413 1.451-1.413h3.193c.967 0 1.451.484 1.451 1.393v2.515c0 .948-.484 1.432-1.451 1.432m0 31.54h-3.193c-.967 0-1.451-.484-1.451-1.413V12.709c0-.929.484-1.413 1.451-1.413h3.193c.967 0 1.451.484 1.451 1.413v25.348c0 .929-.484 1.413-1.451 1.413m23.57-22.578a1.26 1.26 0 0 1-1.296.387c-1.877-.484-4.47-.774-7.663-.774a2.96 2.96 0 0 0-2.264 1.026 3.44 3.44 0 0 0-1.026 2.535V30.65a3.48 3.48 0 0 0 .967 2.477 3.04 3.04 0 0 0 2.322 1.084c3.193 0 5.728-.271 7.624-.755a1.22 1.22 0 0 1 1.277.329 1.6 1.6 0 0 1 .503 1.026v2.206q0 2.419-9.385 2.419a9.3 9.3 0 0 1-6.637-2.477 8.19 8.19 0 0 1-2.748-6.308V20.086a8.2 8.2 0 0 1 2.709-6.269 9.56 9.56 0 0 1 6.676-2.515q9.385 0 9.385 2.419v2.206a1.57 1.57 0 0 1-.445.967m34.81 21.324c0 .813-.426 1.238-1.354 1.238h-3.289a1.55 1.55 0 0 1-1.606-1.142l-3.018-9.599h-12.384l-3 9.598a1.47 1.47 0 0 1-1.548 1.142h-3.289c-.909 0-1.354-.426-1.354-1.238a.8.8 0 0 1 .058-.387l11.532-36.688A1.55 1.55 0 0 1 110.642 0h4.412a1.55 1.55 0 0 1 1.625 1.161l11.474 36.707a.8.8 0 0 1 .097.368zM112.848 9.017l-4.47 14.358h8.94zm35.081 7.875a1.26 1.26 0 0 1-1.296.387c-1.877-.484-4.47-.774-7.663-.774a2.98 2.98 0 0 0-2.264 1.026 3.48 3.48 0 0 0-1.026 2.535V30.65a3.5 3.5 0 0 0 .967 2.477 3.04 3.04 0 0 0 2.322 1.084 31.5 31.5 0 0 0 7.604-.755 1.24 1.24 0 0 1 1.296.329 1.6 1.6 0 0 1 .484 1.026v2.206q0 2.419-9.365 2.419a9.3 9.3 0 0 1-6.635-2.478 8.19 8.19 0 0 1-2.748-6.308V20.085a8.22 8.22 0 0 1 2.709-6.269 9.56 9.56 0 0 1 6.676-2.515q9.385 0 9.385 2.419v2.206a1.55 1.55 0 0 1-.464.967zm15.906 22.407-2.264.155c-2.651.155-4.837-.58-6.695-2.38a8.7 8.7 0 0 1-2.748-6.521V5.631c0-.774.658-1.296 1.896-1.567l2.574-.329a1.32 1.32 0 0 1 1.142.329 1.55 1.55 0 0 1 .484 1.084v6.25h5.534c.967 0 1.451.484 1.451 1.393v2.495c0 .909-.484 1.393-1.451 1.393h-5.553v13.894a3.56 3.56 0 0 0 .967 2.535 3.04 3.04 0 0 0 2.322 1.084h2.264c.967 0 1.471.484 1.471 1.393v2.322c0 .871-.503 1.354-1.413 1.413zm9.772-31.385h-3.676c-.967 0-1.432-.484-1.432-1.413V3.986c0-.929.484-1.413 1.451-1.413h3.676c.967 0 1.451.484 1.451 1.393v2.515c-.019.948-.503 1.432-1.471 1.432m0 31.54h-3.173c-.967 0-1.451-.484-1.451-1.413V12.692c0-.929.484-1.413 1.451-1.413h3.173c.967 0 1.471.484 1.471 1.413V38.04c-.019.929-.503 1.413-1.471 1.413m25.504-2.495a9.52 9.52 0 0 1-6.695 2.477h-4.257a9.25 9.25 0 0 1-6.579-2.477 8.17 8.17 0 0 1-2.728-6.327V20.066a8.19 8.19 0 0 1 2.709-6.269 9.56 9.56 0 0 1 6.676-2.515h4.18a9.3 9.3 0 0 1 6.618 2.477 8.19 8.19 0 0 1 2.767 6.308v10.565a8.32 8.32 0 0 1-2.709 6.327zm-3.406-16.892a3.5 3.5 0 0 0-.967-2.477 3.23 3.23 0 0 0-2.322-1.084h-4.218a3 3 0 0 0-2.322 1.026 3.62 3.62 0 0 0-.967 2.515l-.058 10.584a3.5 3.5 0 0 0 .967 2.496 3.23 3.23 0 0 0 2.38 1.064h4.218a2.98 2.98 0 0 0 2.264-1.006 3.48 3.48 0 0 0 1.026-2.554zm31.134 19.35h-3.173c-.967 0-1.471-.484-1.471-1.393V20.066a3.5 3.5 0 0 0-.967-2.477 3.2 3.2 0 0 0-2.322-1.084h-4.218a3.02 3.02 0 0 0-2.322 1.026 3.46 3.46 0 0 0-1.026 2.515l.058 17.995c0 .909-.484 1.393-1.509 1.393h-3.115c-.967 0-1.471-.484-1.471-1.413V20.064a8.32 8.32 0 0 1 2.709-6.308 9.52 9.52 0 0 1 6.695-2.496h4.199a9.3 9.3 0 0 1 6.637 2.496 8.19 8.19 0 0 1 2.748 6.308v17.957c0 .929-.503 1.413-1.471 1.413zm20.511-2.322c-1.838 1.548-4.063 2.322-6.695 2.322q-9.385 0-9.385-2.419v-2.225a1.57 1.57 0 0 1 .426-.967 1.16 1.16 0 0 1 1.296-.387 31.5 31.5 0 0 0 7.663.774 3.37 3.37 0 0 0 2.322-.832 2.94 2.94 0 0 0 .967-2.264c0-.793-.445-1.451-1.296-1.993l-2.419-1.084a65 65 0 0 1-6.057-2.844 6.44 6.44 0 0 1-2.922-5.534c0-2.535.909-4.586 2.709-6.095s4.025-2.264 6.676-2.264q9.23 0 9.211 2.419v2.206a1.57 1.57 0 0 1-.426.967 1.24 1.24 0 0 1-1.296.387 31.2 31.2 0 0 0-7.488-.774 3.43 3.43 0 0 0-2.38.813 3.1 3.1 0 0 0-.909 2.283c0 .793.426 1.451 1.238 1.993a23 23 0 0 0 2.438 1.084c3.289 1.354 5.283 2.322 6.076 2.844A6.44 6.44 0 0 1 250 31.077c0 2.515-.909 4.528-2.709 6.037h.039z"/></svg>
                </a>
                <ul>
                    <li><a href="https://civicactions.com/">CivicActions</a></li>
                    <li><a href="https://github.com/CivicActions/open-practice/">GitHub Repository</a></li>
                </ul>
            `;
            sidebar.appendChild(logoContainer);
        }

        // Function to update the pagination and footer links
        function updatePagination(currentFileIndex) {
            paginationContainer.innerHTML = ''; // Clear existing buttons

            const prevFile = markdownFiles[currentFileIndex - 1];
            const nextFile = markdownFiles[currentFileIndex + 1];

            // Create a container for the navigation buttons
            const navButtonsWrapper = document.createElement('div');
            navButtonsWrapper.style.display = 'flex';
            navButtonsWrapper.style.justifyContent = 'space-between';
            navButtonsWrapper.style.width = '100%';
            navButtonsWrapper.style.marginTop = '1rem';
            
            // Create and append the "Previous" button if it exists
            if (prevFile) {
                const prevButton = document.createElement('a');
                prevButton.href = `?file=${prevFile.name}`;
                prevButton.textContent = '← Previous';
                prevButton.classList.add('pagination-button');
                prevButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    fetchAndRenderMarkdown(prevFile.name);
                });
                navButtonsWrapper.appendChild(prevButton);
            } else {
                const spacer = document.createElement('div');
                navButtonsWrapper.appendChild(spacer);
            }

            // Create and append the "Next" button if it exists
            if (nextFile) {
                const nextButton = document.createElement('a');
                nextButton.href = `?file=${nextFile.name}`;
                nextButton.textContent = 'Next →';
                nextButton.classList.add('pagination-button');
                nextButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    fetchAndRenderMarkdown(nextFile.name);
                });
                navButtonsWrapper.appendChild(nextButton);
            } else {
                const spacer = document.createElement('div');
                navButtonsWrapper.appendChild(spacer);
            }

            // Append the navigation buttons wrapper to the main container
            paginationContainer.appendChild(navButtonsWrapper);

            // Create a wrapper for the bottom links
            const bottomLinksWrapper = document.createElement('div');
            bottomLinksWrapper.classList.add('bottom-links-wrapper');

            // Add the "Help improve this page" link
            const improvePageLink = document.createElement('a');
            const githubFileUrl = `https://github.com/${repoOwner}/${repoName}/blob/${branch}/${contentPath}/${markdownFiles[currentFileIndex].name}`;
            improvePageLink.href = githubFileUrl;
            improvePageLink.textContent = 'Help improve this page';
            improvePageLink.target = '_blank'; // Open in a new tab
            improvePageLink.classList.add('improve-page-link');
            bottomLinksWrapper.appendChild(improvePageLink);

            // Add the "Back to Top" button
            const backToTopButton = document.createElement('a');
            backToTopButton.href = '#top';
            backToTopButton.textContent = 'Back to Top';
            backToTopButton.classList.add('back-to-top-button');
            backToTopButton.addEventListener('click', (e) => {
                e.preventDefault();
                document.querySelector('body').scrollIntoView({ behavior: 'smooth' });
            });
            bottomLinksWrapper.appendChild(backToTopButton);
            
            // Append the bottom links wrapper
            paginationContainer.appendChild(bottomLinksWrapper);
        }

        // Function to update the active state of a link in the sidebar
        function updateActiveLink(filename) {
            const currentActive = navigationContainer.querySelector('.active');
            if (currentActive) {
                currentActive.classList.remove('active');
            }
            const newActiveLink = navigationContainer.querySelector(`a[data-filename="${filename}"]`);
            if (newActiveLink) {
                newActiveLink.classList.add('active');
            }
        }

        // Function to create and add the logo container
        function createLogoContainer() {
            // Remove existing logo container if it exists
            const existingLogo = document.querySelector('.logo-container');
            if (existingLogo) {
                existingLogo.remove();
            }

            const logoContainer = document.createElement('div');
            logoContainer.className = 'logo-container';
            logoContainer.innerHTML = `
                <a href="https://civicactions.com/">
                    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="title" viewBox="0 0 250 39.474" width="250" height="39.474"><title id="title">CivicActions Logo</title><path fill="#f9f9f7" d="M24.323 12.577H21.13q-1.451 0-1.451-1.451V8.978a3.54 3.54 0 0 0-.967-2.535 3.2 3.2 0 0 0-2.322-1.084H9.385a3 3 0 0 0-2.322 1.026 3.48 3.48 0 0 0-1.026 2.593v21.517a3.56 3.56 0 0 0 .987 2.535 3.2 3.2 0 0 0 2.322 1.084h7.063a2.96 2.96 0 0 0 2.264-1.026 3.5 3.5 0 0 0 1.026-2.593v-2.206c0-.929.484-1.413 1.451-1.413h3.135c.967 0 1.451.484 1.451 1.413v2.206a8.48 8.48 0 0 1-2.709 6.424 9.33 9.33 0 0 1-6.618 2.515H9.346a9.3 9.3 0 0 1-6.579-2.515A8.32 8.32 0 0 1 0 30.495V8.978a8.48 8.48 0 0 1 2.709-6.424A9.56 9.56 0 0 1 9.404 0h7.005a9.33 9.33 0 0 1 6.617 2.515 8.32 8.32 0 0 1 2.748 6.443v2.206c0 .909-.503 1.393-1.471 1.393m9.481-4.663h-3.173c-.967 0-1.471-.484-1.471-1.413V3.966c0-.929.503-1.413 1.471-1.413h3.173c.967 0 1.451.484 1.451 1.393v2.515c0 .948-.484 1.432-1.451 1.432m0 31.54h-3.173c-.967 0-1.471-.484-1.471-1.413V12.672c0-.929.503-1.413 1.471-1.413h3.173c.967 0 1.451.484 1.451 1.413V38.02c0 .929-.484 1.413-1.451 1.413m20.046-1.142a1.47 1.47 0 0 1-1.548 1.142h-3.907a1.55 1.55 0 0 1-1.606-1.142l-8.127-25.464a.8.8 0 0 1-.058-.387c0-.813.426-1.238 1.354-1.238h3.019a1.47 1.47 0 0 1 1.548 1.142l5.805 18.189 5.805-18.189a1.59 1.59 0 0 1 1.625-1.142h2.98c.909 0 1.354.426 1.354 1.238a.8.8 0 0 1-.077.387zm16.06-30.36h-3.193c-.967 0-1.451-.484-1.451-1.413V4.003c0-.929.484-1.413 1.451-1.413h3.193c.967 0 1.451.484 1.451 1.393v2.515c0 .948-.484 1.432-1.451 1.432m0 31.54h-3.193c-.967 0-1.451-.484-1.451-1.413V12.709c0-.929.484-1.413 1.451-1.413h3.193c.967 0 1.451.484 1.451 1.413v25.348c0 .929-.484 1.413-1.451 1.413m23.57-22.578a1.26 1.26 0 0 1-1.296.387c-1.877-.484-4.47-.774-7.663-.774a2.96 2.96 0 0 0-2.264 1.026 3.44 3.44 0 0 0-1.026 2.535V30.65a3.48 3.48 0 0 0 .967 2.477 3.04 3.04 0 0 0 2.322 1.084c3.193 0 5.728-.271 7.624-.755a1.22 1.22 0 0 1 1.277.329 1.6 1.6 0 0 1 .503 1.026v2.206q0 2.419-9.385 2.419a9.3 9.3 0 0 1-6.637-2.477 8.19 8.19 0 0 1-2.748-6.308V20.086a8.2 8.2 0 0 1 2.709-6.269 9.56 9.56 0 0 1 6.676-2.515q9.385 0 9.385 2.419v2.206a1.57 1.57 0 0 1-.445.967m34.81 21.324c0 .813-.426 1.238-1.354 1.238h-3.289a1.55 1.55 0 0 1-1.606-1.142l-3.018-9.599h-12.384l-3 9.598a1.47 1.47 0 0 1-1.548 1.142h-3.289c-.909 0-1.354-.426-1.354-1.238a.8.8 0 0 1 .058-.387l11.532-36.688A1.55 1.55 0 0 1 110.642 0h4.412a1.55 1.55 0 0 1 1.625 1.161l11.474 36.707a.8.8 0 0 1 .097.368zM112.848 9.017l-4.47 14.358h8.94zm35.081 7.875a1.26 1.26 0 0 1-1.296.387c-1.877-.484-4.47-.774-7.663-.774a2.98 2.98 0 0 0-2.264 1.026 3.48 3.48 0 0 0-1.026 2.535V30.65a3.5 3.5 0 0 0 .967 2.477 3.04 3.04 0 0 0 2.322 1.084 31.5 31.5 0 0 0 7.604-.755 1.24 1.24 0 0 1 1.296.329 1.6 1.6 0 0 1 .484 1.026v2.206q0 2.419-9.365 2.419a9.3 9.3 0 0 1-6.635-2.478 8.19 8.19 0 0 1-2.748-6.308V20.085a8.22 8.22 0 0 1 2.709-6.269 9.56 9.56 0 0 1 6.676-2.515q9.385 0 9.385 2.419v2.206a1.55 1.55 0 0 1-.464.967zm15.906 22.407-2.264.155c-2.651.155-4.837-.58-6.695-2.38a8.7 8.7 0 0 1-2.748-6.521V5.631c0-.774.658-1.296 1.896-1.567l2.574-.329a1.32 1.32 0 0 1 1.142.329 1.55 1.55 0 0 1 .484 1.084v6.25h5.534c.967 0 1.451.484 1.451 1.393v2.495c0 .909-.484 1.393-1.451 1.393h-5.553v13.894a3.56 3.56 0 0 0 .967 2.535 3.04 3.04 0 0 0 2.322 1.084h2.264c.967 0 1.471.484 1.471 1.393v2.322c0 .871-.503 1.354-1.413 1.413zm9.772-31.385h-3.676c-.967 0-1.432-.484-1.432-1.413V3.986c0-.929.484-1.413 1.451-1.413h3.676c.967 0 1.451.484 1.451 1.393v2.515c-.019.948-.503 1.432-1.471 1.432m0 31.54h-3.173c-.967 0-1.451-.484-1.451-1.413V12.692c0-.929.484-1.413 1.451-1.413h3.173c.967 0 1.471.484 1.471 1.413V38.04c-.019.929-.503 1.413-1.471 1.413m25.504-2.495a9.52 9.52 0 0 1-6.695 2.477h-4.257a9.25 9.25 0 0 1-6.579-2.477 8.17 8.17 0 0 1-2.728-6.327V20.066a8.19 8.19 0 0 1 2.709-6.269 9.56 9.56 0 0 1 6.676-2.515h4.18a9.3 9.3 0 0 1 6.618 2.477 8.19 8.19 0 0 1 2.767 6.308v10.565a8.32 8.32 0 0 1-2.709 6.327zm-3.406-16.892a3.5 3.5 0 0 0-.967-2.477 3.23 3.23 0 0 0-2.322-1.084h-4.218a3 3 0 0 0-2.322 1.026 3.62 3.62 0 0 0-.967 2.515l-.058 10.584a3.5 3.5 0 0 0 .967 2.496 3.23 3.23 0 0 0 2.38 1.064h4.218a2.98 2.98 0 0 0 2.264-1.006 3.48 3.48 0 0 0 1.026-2.554zm31.134 19.35h-3.173c-.967 0-1.471-.484-1.471-1.393V20.066a3.5 3.5 0 0 0-.967-2.477 3.2 3.2 0 0 0-2.322-1.084h-4.218a3.02 3.02 0 0 0-2.322 1.026 3.46 3.46 0 0 0-1.026 2.515l.058 17.995c0 .909-.484 1.393-1.509 1.393h-3.115c-.967 0-1.471-.484-1.471-1.413V20.064a8.32 8.32 0 0 1 2.709-6.308 9.52 9.52 0 0 1 6.695-2.496h4.199a9.3 9.3 0 0 1 6.637 2.496 8.19 8.19 0 0 1 2.748 6.308v17.957c0 .929-.503 1.413-1.471 1.413zm20.511-2.322c-1.838 1.548-4.063 2.322-6.695 2.322q-9.385 0-9.385-2.419v-2.225a1.57 1.57 0 0 1 .426-.967 1.16 1.16 0 0 1 1.296-.387 31.5 31.5 0 0 0 7.663.774 3.37 3.37 0 0 0 2.322-.832 2.94 2.94 0 0 0 .967-2.264c0-.793-.445-1.451-1.296-1.993l-2.419-1.084a65 65 0 0 1-6.057-2.844 6.44 6.44 0 0 1-2.922-5.534c0-2.535.909-4.586 2.709-6.095s4.025-2.264 6.676-2.264q9.23 0 9.211 2.419v2.206a1.57 1.57 0 0 1-.426.967 1.24 1.24 0 0 1-1.296.387 31.2 31.2 0 0 0-7.488-.774 3.43 3.43 0 0 0-2.38.813 3.1 3.1 0 0 0-.909 2.283c0 .793.426 1.451 1.238 1.993a23 23 0 0 0 2.438 1.084c3.289 1.354 5.283 2.322 6.076 2.844A6.44 6.44 0 0 1 250 31.077c0 2.515-.909 4.528-2.709 6.037h.039z"/></svg>
                </a>
                <ul>
                    <li><a href="https://civicactions.com/">CivicActions</a></li>
                    <li><a href="https://github.com/CivicActions/open-practice/">GitHub Repository</a></li>
                </ul>
            `;
            document.body.appendChild(logoContainer);

            // Adjust logo container width based on sidebar width
            const sidebar = document.getElementById('sidebar');
            const updateLogoWidth = () => {
                const sidebarRect = sidebar.getBoundingClientRect();
                logoContainer.style.width = sidebarRect.width + 'px';
                logoContainer.style.left = sidebarRect.left + 'px';
            };

            // Update width initially and on resize
            updateLogoWidth();
            window.addEventListener('resize', updateLogoWidth);
        }

        // Main function to initialize the app
        async function initialize() {
            markdownFiles = await fetchFileList();

            if (markdownFiles.length === 0) {
                navigationContainer.innerHTML = '<li><p style="color: var(--blue-100); font-size: 0.875rem; padding: 1rem; animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;">No markdown files found.</p></li>';
                return;
            }

            // Sort the files alphabetically, case-insensitively
            markdownFiles.sort((a, b) => a.name.localeCompare(b.name));
            
            // Find README.md and move it to the front
            const readmeIndex = markdownFiles.findIndex(file => file.name.toLowerCase() === 'readme.md');
            if (readmeIndex > -1) {
                const readmeFile = markdownFiles.splice(readmeIndex, 1)[0];
                markdownFiles.unshift(readmeFile);
            }
            
            // Clear the loading message
            navigationContainer.innerHTML = '';

            // Build navigation links
            markdownFiles.forEach((file) => {
                const listItem = document.createElement('li');
                const link = document.createElement('a');
                link.href = `?file=${file.name}`; // Use ?file=
                link.textContent = file.name.replace('.md', '').split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
                link.classList.add('navigation-link');
                link.setAttribute('data-filename', file.name);
                
                // Add click event listener to each link
                link.addEventListener('click', (event) => {
                    event.preventDefault();
                    fetchAndRenderMarkdown(file.name);
                });
                
                listItem.appendChild(link);
                navigationContainer.appendChild(listItem);
            });
            
            // Get the initial file from the query string
            const urlParams = new URLSearchParams(window.location.search);
            const initialFile = urlParams.get('file') || 'README.md';

            // Load content based on query string or default to the README.md file
            if (initialFile) {
                fetchAndRenderMarkdown(initialFile);
                updateActiveLink(initialFile);
            }
        }
        
        // Add a popstate listener for back/forward buttons
        window.addEventListener('popstate', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const newFile = urlParams.get('file');
            if (newFile) {
                fetchAndRenderMarkdown(newFile);
                updateActiveLink(newFile);
            }
        });
        
        // Start the application
        initialize();

        sidebarOverlay.classList.remove('is-active');

    })();
</script>
</body>
</html>
